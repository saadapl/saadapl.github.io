System.register([],function(W){"use strict";return{execute:function(){W("atom",Q);let G=0;function Q(e,s){const u=`atom${++G}`,c={toString(){return u}};return typeof e=="function"?c.read=e:(c.init=e,c.read=V,c.write=Y),s&&(c.write=s),c}function V(e){return e(this)}function Y(e,s,u){return s(this,typeof u=="function"?u(e(this)):u)}const j=(e,s)=>e.unstable_is?e.unstable_is(s):s===e,F=e=>"init"in e,J=e=>!!e.write,b=new WeakMap,A=e=>{var s;return _(e)&&!((s=b.get(e))!=null&&s[1])},$=(e,s)=>{const u=b.get(e);u&&(u[1]=!0,u[0].forEach(c=>c(s)))},x=e=>{if(b.has(e))return;const s=[new Set,!1];b.set(e,s);const u=()=>{s[1]=!0};e.then(u,u),e.onCancel=c=>{s[0].add(c)}},_=e=>typeof(e==null?void 0:e.then)=="function",K=e=>"v"in e||"e"in e,E=e=>{if("e"in e)throw e.e;return e.v},N=(e,s,u)=>{u.p.has(e)||(u.p.add(e),s.then(()=>{u.p.delete(e)},()=>{u.p.delete(e)}))},Z=(e,s,u,c)=>{var k;s.d.set(u,c.n),A(s.v)&&N(e,s.v,c),(k=c.m)==null||k.t.add(e)},nn=Symbol.for("JOTAI.EXPERIMENTAL.FLUSHSTOREHOOK"),P=(...e)=>{const[s,u,c,k,U,en]=e,y=t=>{let n=s(t);return n||(n={d:new Map,p:new Set,n:0},u(t,n),U==null||U(t,O)),n},v=new WeakMap,m=new Map,M=new Set,z=new Set,p=()=>{var t;const n=[],r=l=>{try{l()}catch(a){n.push(a)}};do{(t=O[nn])==null||t.call(O);const l=new Set,a=l.add.bind(l);m.forEach(o=>{var i;return(i=o.m)==null?void 0:i.l.forEach(a)}),m.clear(),M.forEach(a),M.clear(),z.forEach(a),z.clear(),l.forEach(r),m.size&&S()}while(m.size||M.size||z.size);if(n.length)throw n[0]},I=(t,n,r)=>{const l="v"in n,a=n.v,o=A(n.v)?n.v:null;if(_(r)){x(r);for(const i of n.d.keys())N(t,r,y(i));n.v=r}else n.v=r;delete n.e,(!l||!Object.is(a,n.v))&&(++n.n,o&&$(o,r))},g=t=>{var n;const r=y(t);if(K(r)&&(r.m&&v.get(t)!==r.n||Array.from(r.d).every(([f,w])=>g(f).n===w)))return r;r.d.clear();let l=!0;const a=()=>{r.m&&(D(t,r),S(),p())},o=f=>{if(j(t,f)){const R=y(f);if(!K(R))if(F(f))I(f,R,f.init);else throw new Error("no atom init");return E(R)}const w=g(f);try{return E(w)}finally{Z(t,r,f,w),l||a()}};let i,d;const h={get signal(){return i||(i=new AbortController),i.signal},get setSelf(){return!d&&J(t)&&(d=(...f)=>{if(!l)return B(t,...f)}),d}};try{const f=c(t,o,h);return I(t,r,f),_(f)&&((n=f.onCancel)==null||n.call(f,()=>i==null?void 0:i.abort()),f.then(a,a)),r}catch(f){return delete r.v,r.e=f,++r.n,r}finally{l=!1}},rn=t=>E(g(t)),X=t=>{var n;const r=new Map;for(const l of((n=t.m)==null?void 0:n.t)||[]){const a=y(l);a.m&&r.set(l,a)}for(const l of t.p)r.set(l,y(l));return r},q=t=>{const n=[t];for(;n.length;){const r=n.pop();for(const[l,a]of X(r))v.has(l)||(v.set(l,a.n),n.push(a))}},S=()=>{var t;const n=[],r=new WeakSet,l=new WeakSet,a=Array.from(m);for(;a.length;){const[o,i]=a[a.length-1];if(l.has(o)){a.pop();continue}if(r.has(o)){v.get(o)===i.n?n.push([o,i,i.n]):(v.delete(o),m.set(o,i)),l.add(o),a.pop();continue}r.add(o);for(const[d,h]of X(i))r.has(d)||a.push([d,h])}for(let o=n.length-1;o>=0;--o){const[i,d,h]=n[o];let f=!1;for(const w of d.d.keys())if(w!==i&&m.has(w)){f=!0;break}f&&(g(i),D(i,d),h!==d.n&&(m.set(i,d),(t=d.u)==null||t.call(d))),v.delete(i)}},T=(t,...n)=>{let r=!0;const l=o=>E(g(o)),a=(o,...i)=>{var d;const h=y(o);try{if(j(t,o)){if(!F(o))throw new Error("atom not writable");const f=h.n,w=i[0];I(o,h,w),D(o,h),f!==h.n&&(m.set(o,h),(d=h.u)==null||d.call(h),q(h));return}else return T(o,...i)}finally{r||(S(),p())}};try{return k(t,l,a,...n)}finally{r=!1}},B=(t,...n)=>{try{return T(t,...n)}finally{S(),p()}},D=(t,n)=>{var r;if(n.m&&!A(n.v)){for(const[l,a]of n.d)if(!n.m.d.has(l)){const o=y(l);H(l,o).t.add(t),n.m.d.add(l),a!==o.n&&(m.set(l,o),(r=o.u)==null||r.call(o),q(o))}for(const l of n.m.d||[])if(!n.d.has(l)){n.m.d.delete(l);const a=L(l,y(l));a==null||a.t.delete(t)}}},H=(t,n)=>{var r;if(!n.m){g(t);for(const l of n.d.keys())H(l,y(l)).t.add(t);if(n.m={l:new Set,d:new Set(n.d.keys()),t:new Set},(r=n.h)==null||r.call(n),J(t)){const l=n.m,a=()=>{let o=!0;const i=(...d)=>{try{return T(t,...d)}finally{o||(S(),p())}};try{const d=en(t,i);d&&(l.u=()=>{o=!0;try{d()}finally{o=!1}})}finally{o=!1}};z.add(a)}}return n.m},L=(t,n)=>{var r;if(n.m&&!n.m.l.size&&!Array.from(n.m.t).some(l=>{var a;return(a=y(l).m)==null?void 0:a.d.has(t)})){const l=n.m.u;l&&M.add(l),delete n.m,(r=n.h)==null||r.call(n);for(const a of n.d.keys()){const o=L(a,y(a));o==null||o.t.delete(t)}return}return n.m},O={get:rn,set:B,sub:(t,n)=>{const r=y(t),l=H(t,r).l;return l.add(n),p(),()=>{l.delete(n),L(t,r),p()}},unstable_derive:t=>P(...t(...e))};return O},tn=W("createStore",()=>{const e=new WeakMap;return P(s=>e.get(s),(s,u)=>e.set(s,u).get(s),(s,...u)=>s.read(...u),(s,...u)=>s.write(...u),(s,...u)=>{var c;return(c=s.unstable_onInit)==null?void 0:c.call(s,...u)},(s,...u)=>{var c;return(c=s.onMount)==null?void 0:c.call(s,...u)})});let C;const ln=W("getDefaultStore",()=>(C||(C=tn()),C))}}});
